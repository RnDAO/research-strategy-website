---
import { Icon } from 'astro-icon'
---

<div class="ml-3 relative" x-data="{ themeOpen: false }">
  <div>
    <button
      type="button"
      class="btn inline-flex items-center justify-center w-full rounded-md border border-zinc-300 dark:border-zinc-700 shadow-sm px-4 py-2 bg-white dark:bg-zinc-800 text-sm font-medium text-gray-700 dark:text-zinc-100 hover:bg-zinc-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-zinc-300 dark:focus:ring-offset-zinc-700 focus:ring-zinc-500"
      id="menu-button"
      aria-expanded="true"
      aria-haspopup="true"
      x-on:click="themeOpen = !themeOpen"
    >
      <Icon
        class="h-8 w-8"
        pack="heroicons-outline"
        name="star"
        x-cloak
        x-show="!localStorage.theme"
      />
      <Icon
        class="h-8 w-8"
        pack="heroicons-outline"
        name="moon"
        x-cloak
        x-show="localStorage.theme === 'dark'"
      />
      <Icon
        class="h-8 w-8"
        pack="heroicons-outline"
        name="sun"
        x-cloak
        x-show="localStorage.theme === 'light'"
      />
      <Icon
        class="-mr-1 ml-2 h-5 w-5"
        aria-hidden="true"
        pack="heroicons-solid"
        name="chevron-down"
      />
    </button>
  </div>
  <ul
    x-show="themeOpen"
    x-cloak
    x-transition:enter="transition ease-out duration-100"
    x-transition:enter-start="transform opacity-0 scale-95"
    x-transition:enter-end="transform opacity-100 scale-100"
    x-transition:leave="transition ease-in duration-75"
    x-transition:leave-start="transform opacity-100 scale-100"
    x-transition:leave-end="transform opacity-0 scale-95"
    class="absolute z-20 mt-1 w-[150%] -right-1/4 bg-white dark:bg-zinc-900 shadow-lg max-h-56 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm"
    tabindex="-1"
    role="listbox"
    aria-labelledby="listbox-label"
    aria-activedescendant="listbox-option-3"
  >
    <li
      class="text-zinc-900 hover:text-white hover:bg-zinc-600 dark:bg-zinc-900 dark:text-white dark:hover:text-zinc-900 dark:hover:bg-zinc-300 cursor-default select-none relative py-2 pl-2 pr-4"
      id="listbox-option-0"
      role="option"
      x-on:click="localStorage.removeItem('theme'); window.location.reload()"
    >
      <div
        class="flex items-center"
        x-bind:class="!localStorage.theme ? 'text-green-600' : 'text-zinc-800 dark:text-zinc-500'"
      >
        <Icon class="h-6 w-6" pack="heroicons-outline" name="star" />
        <!-- Selected: "font-semibold", Not Selected: "font-normal" -->
        <span
          class="ml-1 block truncate"
          x-bind:class="localStorage.theme ? 'font-normal' : 'font-semibold'"
          >System</span
        >
      </div>
    </li>
    <li
      class="text-gray-900 hover:text-white hover:bg-zinc-600 dark:bg-zinc-900 dark:text-white dark:hover:text-zinc-900 dark:hover:bg-zinc-300 cursor-default select-none relative py-2 pl-2 pr-4"
      id="listbox-option-0"
      role="option"
      x-on:click="localStorage.theme = 'light'; window.location.reload()"
    >
      <div
        class="flex items-center"
        x-bind:class="localStorage.theme == 'light' ? 'text-green-600' : 'text-zinc-800 dark:text-zinc-500'"
      >
        <Icon class="h-6 w-6" pack="heroicons-outline" name="sun" />
        <!-- Selected: "font-semibold", Not Selected: "font-normal" -->
        <span
          class="ml-1 block truncate"
          x-bind:class="localStorage.theme == 'light' ? 'font-semibold' : 'font-normal'"
          >Light</span
        >
      </div>
    </li>
    <li
      class="text-gray-900 hover:text-white hover:bg-zinc-600 dark:bg-zinc-900 dark:text-white dark:hover:text-zinc-900 dark:hover:bg-zinc-300 cursor-default select-none relative py-2 pl-2 pr-4"
      id="listbox-option-0"
      role="option"
      x-on:click="localStorage.theme = 'dark'; window.location.reload()"
    >
      <div
        class="flex items-center"
        x-bind:class="localStorage.theme == 'dark' ? 'text-green-600' : 'text-zinc-800 dark:text-zinc-500'"
      >
        <Icon class="h-6 w-6" pack="heroicons-solid" name="moon" />
        <!-- Selected: "font-semibold", Not Selected: "font-normal" -->
        <span
          class="ml-1 block truncate"
          x-bind:class="localStorage.theme == 'dark' ? 'font-semibold' : 'font-normal'"
          >Dark</span
        >
      </div>
    </li>
  </ul>
</div>
